# 打包说明

## 前提条件

1. 已安装 Python 3.7+
2. 已运行 `npm run build` 构建项目（生成 dist 目录）

## 安装 PyInstaller

```bash
pip install pyinstaller
```

## 打包步骤

### 方法一：使用命令行直接打包

```bash
pyinstaller --onefile --noconsole --add-data "dist;dist" --icon=public/deltaforce.png --name "三角洲舔包模拟器" launcher.py
```

参数说明：
- `--onefile`: 打包成单个 exe 文件
- `--noconsole`: 不显示控制台窗口（如需调试可去掉此参数）
- `--add-data "dist;dist"`: 将 dist 目录打包进 exe（Windows 用分号，Linux/Mac 用冒号）
- `--icon`: 指定图标文件（可选）
- `--name`: 指定输出文件名

### 方法二：使用 spec 文件打包（推荐）

1. 首先生成 spec 文件：

```bash
pyinstaller launcher.py --onefile --noconsole --name "三角洲舔包模拟器"
```

2. 编辑生成的 `三角洲舔包模拟器.spec` 文件，在 `a = Analysis(...)` 部分添加 datas：

```python
a = Analysis(
    ['launcher.py'],
    pathex=[],
    binaries=[],
    datas=[('dist', 'dist')],  # 添加这一行
    ...
)
```

3. 使用 spec 文件打包：

```bash
pyinstaller "三角洲舔包模拟器.spec"
```

### 方法三：使用提供的批处理文件（Windows）

直接运行 `build_exe.bat`

## 输出位置

打包完成后，exe 文件位于 `dist/三角洲舔包模拟器.exe`

## 使用方法

1. 双击运行 `三角洲舔包模拟器.exe`
2. 程序会自动启动 Web 服务器（端口 8888）
3. 浏览器会自动打开游戏页面
4. 按 Ctrl+C 停止服务器

## 注意事项

1. **dist 目录必须存在**: 打包前确保已运行 `npm run build`
2. **端口占用**: 如果 8888 端口被占用，可以编辑 launcher.py 修改 PORT 变量
3. **防火墙**: 首次运行可能需要允许防火墙访问
4. **文件大小**: 由于包含了整个 dist 目录和 Python 运行时，exe 文件可能较大（50-100MB）

## 常见问题

### Q: 打包后运行 exe 提示找不到 dist 目录？
A: 检查 spec 文件中是否正确添加了 `datas=[('dist', 'dist')]`

### Q: 如何修改端口？
A: 编辑 launcher.py，修改 `PORT = 8888` 为其他端口号

### Q: 如何显示控制台窗口？
A: 去掉打包命令中的 `--noconsole` 参数

### Q: 能否发布给其他用户？
A: 可以，只需要分发打包后的 exe 文件即可，无需安装 Python

## 打包优化

如果想减小 exe 文件大小：

1. 使用 `--exclude-module` 排除不需要的模块
2. 考虑使用 UPX 压缩（需额外安装）：

```bash
pip install pyinstaller[compression]
pyinstaller --onefile --noconsole --add-data "dist;dist" --upx-dir=upx launcher.py
```

## 开发测试

在打包前可以直接运行 Python 脚本测试：

```bash
python launcher.py
```
