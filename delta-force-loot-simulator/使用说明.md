# 三角洲舔包模拟器 - 使用说明

## 项目简介

这是一个基于 Web 的三角洲舔包模拟器，用于模拟《三角洲行动》游戏中的搜刮战利品和整理背包的玩法。

## 快速开始

### 方式一：使用打包好的 EXE 启动器（推荐）

1. **获取启动器**
   - 运行 `build_exe.bat` 生成启动器
   - 或直接使用已打包好的 `三角洲舔包模拟器.exe`

2. **运行游戏**
   - 双击 `三角洲舔包模拟器.exe`
   - 程序会自动启动 Web 服务器（端口 8888）
   - 浏览器会自动打开游戏页面
   - 按 Ctrl+C 停止服务器

3. **注意事项**
   - 首次运行可能需要允许防火墙访问
   - 如果 8888 端口被占用，需要修改源代码中的端口号
   - 确保 dist 目录存在（包含游戏文件）

### 方式二：使用 Python 脚本运行

1. **安装 Python**
   - 需要 Python 3.7 或更高版本
   - 下载地址：https://www.python.org/downloads/

2. **构建项目**
   ```bash
   npm run build
   ```

3. **运行启动器**
   ```bash
   python launcher.py
   ```

4. **访问游戏**
   - 浏览器会自动打开 http://localhost:8888
   - 如果未自动打开，手动访问该地址

### 方式三：开发模式运行

1. **安装依赖**
   ```bash
   npm install
   ```

2. **启动开发服务器**
   ```bash
   npm run dev
   ```

3. **访问游戏**
   - 默认地址：http://localhost:5173
   - 支持热更新（修改代码自动刷新）

## 游戏说明

### 基本操作

- **拖动物品**：鼠标左键按住物品拖动
- **旋转物品**：拖动时按 `R` 键旋转物品
- **快速转移**：双击物品或按 `F` 键快速移动到对面区域
- **装备物品**：将物品拖到对应装备槽位
- **装配配件**：将配件拖到枪械上自动装配
- **装填弹药**：将弹药拖到枪械上自动装填

### 游戏界面

1. **左侧区域 - 个人装备**
   - 主武器槽 1 和 2
   - 副武器槽
   - 头盔槽
   - 护甲槽
   - 胸挂槽 + 胸挂容器
   - 背包槽 + 背包容器
   - 口袋（5 个格子）
   - 安全箱（3x3，不能放武器/护甲/配件）

2. **中间区域 - 战利品箱**
   - 显示多个战利品箱
   - 点击底部按钮切换不同的箱子
   - 地面容器（15x8 大格子）

3. **右侧区域 - 控制面板**
   - 总价值显示
   - 计时器
   - 地面容器按钮
   - 重置按钮
   - 截图按钮
   - 搜索全部按钮
   - 智能整理按钮

### 高级功能

#### 智能整理

点击"智能整理"按钮，系统会自动：

1. 扩展地面容器到 15x20
2. 收集所有物品到地面
3. 卸载所有武器配件
4. 选择并装备最好的两把枪（含最优配件）
5. 装备最贵的头盔和护甲
6. 选择最大容量的背包和胸挂
7. 按优先级填充剩余物品到容器

#### 物品优先级（从高到低）

1. 钥匙、贵重收藏品
2. 弹药
3. 医疗用品、高价值物品（>5万）
4. 投掷物、中价值物品（2-5万）
5. 一般物品

## 文件结构

```
delta-force-loot-simulator/
├── dist/                        # 构建输出目录（生产环境）
│   ├── index.html              # 主页面
│   ├── assets/                 # JS/CSS 资源
│   ├── json/                   # 游戏数据文件
│   └── images/                 # 物品图片
├── public/                      # 静态资源
│   ├── json/                   # 原始数据文件
│   │   ├── gun/               # 枪械数据
│   │   ├── acc/               # 配件数据
│   │   ├── protect/           # 防护装备
│   │   ├── props/             # 收藏品/消耗品/钥匙
│   │   ├── container/         # 容器数据
│   │   ├── gunSlotMap.json    # 枪械槽位映射
│   │   ├── data.json          # 完整数据
│   │   └── values.json        # 物品价格
│   └── images/                # 物品图片（1161 张）
├── src/                        # 源代码
├── launcher.py                 # Python 启动器
├── build_exe.bat              # 打包批处理
├── 打包说明.md                 # 打包详细说明
└── README.md                   # 项目说明

```

## 技术栈

- **前端框架**：TypeScript + Vite
- **渲染引擎**：PixiJS v8
- **启动器**：Python 3 + http.server
- **打包工具**：PyInstaller

## 配置说明

### 修改端口

编辑 `launcher.py` 文件：

```python
PORT = 8888  # 修改为其他端口
```

### 切换数据源

编辑 `src/config.ts` 文件：

```typescript
resource_cdn: 'local',  // 'local' | 'jsdelivr' | 'api'
realtime_value: 'local' // 'local' | 'jsdelivr' | 'api'
```

### 调整物品生成概率

编辑 `src/itemManager.ts` 的 `pickingPreset` 配置：

```typescript
"collection": {
    "prob": 0.65,  // 收集品生成概率 65%
    "grades": [0, 0.2, 0.15, 0.2, 0.25, 0.15, 0.05, 0]  // 等级分布
}
```

## 常见问题

### Q: 启动器提示找不到 dist 目录？

A: 需要先运行 `npm run build` 构建项目。

### Q: 端口 8888 被占用怎么办？

A: 编辑 `launcher.py` 修改 `PORT` 变量为其他端口。

### Q: 游戏加载很慢？

A: 首次加载需要下载 1161 张图片，请耐心等待。后续访问会使用浏览器缓存。

### Q: 某些物品图片显示不出来？

A: 有 2 张图片在服务器不存在（15050100021.png, 15050400005.png），这是正常的。

### Q: 如何分享给朋友？

A:
1. 打包成 exe 后，直接发送 `三角洲舔包模拟器.exe`
2. 或者发送整个 dist 文件夹 + launcher.py
3. 朋友无需安装任何依赖即可运行

### Q: 可以在线部署吗？

A: 可以。将 dist 目录部署到任何静态网站托管服务（如 GitHub Pages, Vercel, Netlify 等）。

## 开发说明

### 项目结构

- `src/game.ts`: 游戏主类
- `src/item.ts`: 物品类（拖拽、交互）
- `src/itemManager.ts`: 资源管理器
- `src/region.ts`: 区域容器
- `src/invntory.ts`: 背包系统
- `src/subgrid.ts`: 网格系统
- `src/gridContainer.ts`: 多网格容器
- `src/components/`: UI 组件（按钮、计时器等）

### 添加新物品类型

1. 在对应的 JSON 文件中添加物品数据
2. 确保包含必需字段：`objectID`, `objectName`, `primaryClass`, `secondClass`, `grade`, `length`, `width`, `pic`
3. 容器类物品需要 `subgridLayout` 数组
4. 武器需要 `gunDetail` 对象（包含 `caliber`, `capacity`, `accessory`）
5. 在 `values.json` 中添加价格

### 构建命令

```bash
npm run dev      # 开发模式
npm run build    # 生产构建
npm run preview  # 预览构建结果
```

## 更新日志

### v0.10.3 (当前版本)

- ✅ 修复图片加载性能问题（使用 PIXI 纹理缓存）
- ✅ 添加 253 个收集品数据
- ✅ 添加 30 个消耗品数据
- ✅ 添加 53 个钥匙数据
- ✅ 修正所有物品价格数据（942 个物品）
- ✅ 优化物品生成概率（收藏品 65%，4-5 级物品增加）
- ✅ 创建 Python 启动器
- ✅ 支持一键打包 EXE

## 许可证

本项目仅供学习交流使用。

## 联系方式

- 项目地址：https://github.com/...
- 问题反馈：https://github.com/.../issues

---

**享受游戏！Have fun!**
